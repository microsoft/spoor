# Copyright (c) Microsoft Corporation.
# Licensed under the MIT License.

steps:
- script: |
    wget https://apt.llvm.org/llvm.sh
    chmod +x llvm.sh
    sudo ./llvm.sh 11
  displayName: Install LLVM (Linux)
  condition: eq(variables['Agent.OS'], 'Linux')
- script: |
    brew update
    brew upgrade --force llvm@11
    echo '##vso[task.prependpath]/usr/local/opt/llvm/bin'
  displayName: Install LLVM (macOS)
  condition: eq(variables['Agent.OS'], 'Darwin')
- script: apt-get install protobuf-compiler
  displayName: Install Protocol Buffer compiler (Linux)
  condition: eq(variables['Agent.OS'], 'Linux')
- script: brew install protobuf
  displayName: Install Protocol Buffer compiler (macOS)
  condition: eq(variables['Agent.OS'], 'Darwin')
- script: cp ./.build/ci.bazelrc ./.bazelrc
  displayName: Copy .bazelrc
