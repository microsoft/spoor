
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Spoor documentation and reference.">
      
      
        <meta name="author" content="Microsoft Corporation">
      
      
        <link rel="canonical" href="https://www.spoor.dev/reference/runtime/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>Overview - Spoor</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#546d78">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#runtime" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Spoor" class="md-header__button md-logo" aria-label="Spoor" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M256 224c-79.37 0-191.1 122.7-191.1 200.2-.88 34.9 25.86 55.8 70.9 55.8 48.8 0 81.1-25.1 120.2-25.1 39.5 0 71.9 25.1 120.2 25.1 44.1 0 71.74-20.88 71.74-55.75C447.1 346.8 335.4 224 256 224zm-147.2-12.6c-10.37-34.62-42.5-57.12-71.62-50.12S-7.104 202 3.27 236.6c10.37 34.7 42.5 57.2 71.62 50.2s44.21-40.8 33.91-75.4zm84.7-20.8c30.87-8.125 46.37-49.1 34.5-93.37s-46.5-71.1-77.49-63.87c-30.87 8.125-46.37 49.1-34.5 93.37 11.89 43.37 46.49 72.07 77.49 63.87zm281.4-29.3c-29.12-6.1-61.25 15.5-71.62 50.12-10.37 34.63 4.75 68.37 33.87 75.37 29.12 6.1 61.12-15.5 71.62-50.12C519.1 202 503.1 168.3 474.9 161.3zm-156.4 29.3c30.1 8.125 65.62-20.5 77.49-63.87 11.87-43.37-3.625-85.25-34.5-93.37-30.1-8.125-65.62 20.5-77.49 63.87-11.9 43.37 3.6 85.27 34.5 93.37z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Spoor
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Overview
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/microsoft/spoor" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/spoor
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../get-started/" class="md-tabs__link">
        Get Started
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Reference
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../tutorials/" class="md-tabs__link">
        Tutorials
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../contributing/" class="md-tabs__link">
        Contributing
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Spoor" class="md-nav__button md-logo" aria-label="Spoor" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M256 224c-79.37 0-191.1 122.7-191.1 200.2-.88 34.9 25.86 55.8 70.9 55.8 48.8 0 81.1-25.1 120.2-25.1 39.5 0 71.9 25.1 120.2 25.1 44.1 0 71.74-20.88 71.74-55.75C447.1 346.8 335.4 224 256 224zm-147.2-12.6c-10.37-34.62-42.5-57.12-71.62-50.12S-7.104 202 3.27 236.6c10.37 34.7 42.5 57.2 71.62 50.2s44.21-40.8 33.91-75.4zm84.7-20.8c30.87-8.125 46.37-49.1 34.5-93.37s-46.5-71.1-77.49-63.87c-30.87 8.125-46.37 49.1-34.5 93.37 11.89 43.37 46.49 72.07 77.49 63.87zm281.4-29.3c-29.12-6.1-61.25 15.5-71.62 50.12-10.37 34.63 4.75 68.37 33.87 75.37 29.12 6.1 61.12-15.5 71.62-50.12C519.1 202 503.1 168.3 474.9 161.3zm-156.4 29.3c30.1 8.125 65.62-20.5 77.49-63.87 11.87-43.37-3.625-85.25-34.5-93.37-30.1-8.125-65.62 20.5-77.49 63.87-11.9 43.37 3.6 85.27 34.5 93.37z"/></svg>

    </a>
    Spoor
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/microsoft/spoor" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/spoor
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Get Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Get Started" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Get Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../get-started/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../get-started/xcode-toolchain/" class="md-nav__link">
        Xcode Toolchain
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2">
          Instrumentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Instrumentation" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Instrumentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../instrumentation/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../instrumentation/configuration/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_3">
          Runtime
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Runtime" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Runtime
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Overview
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Overview
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    API
  </a>
  
    <nav class="md-nav" aria-label="API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supported-languages" class="md-nav__link">
    Supported languages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#packaging" class="md-nav__link">
    Packaging
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#runtime-modes" class="md-nav__link">
    Runtime modes
  </a>
  
    <nav class="md-nav" aria-label="Runtime modes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#log-everything" class="md-nav__link">
    Log everything
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#circular-buffer" class="md-nav__link">
    Circular buffer
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trace" class="md-nav__link">
    Trace
  </a>
  
    <nav class="md-nav" aria-label="Trace">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#source-code" class="md-nav__link">
    Source code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#header" class="md-nav__link">
    Header
  </a>
  
    <nav class="md-nav" aria-label="Header">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#magic-number" class="md-nav__link">
    Magic number
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#endianness" class="md-nav__link">
    Endianness
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compression-strategy" class="md-nav__link">
    Compression strategy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#version" class="md-nav__link">
    Version
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session-id" class="md-nav__link">
    Session ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-id" class="md-nav__link">
    Process ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thread-id" class="md-nav__link">
    Thread ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-clock-timestamp" class="md-nav__link">
    System clock timestamp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#steady-clock-timestamp" class="md-nav__link">
    Steady clock timestamp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-count" class="md-nav__link">
    Event count
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#padding" class="md-nav__link">
    Padding
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event" class="md-nav__link">
    Event
  </a>
  
    <nav class="md-nav" aria-label="Event">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#event-id" class="md-nav__link">
    Event ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timestamp" class="md-nav__link">
    Timestamp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#payload" class="md-nav__link">
    Payload
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    Architecture
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memory-management" class="md-nav__link">
    Memory management
  </a>
  
    <nav class="md-nav" aria-label="Memory management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#buffer-pool" class="md-nav__link">
    Buffer pool
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thread-logger" class="md-nav__link">
    Thread logger
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="configuration/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4" type="checkbox" id="__nav_3_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_4">
          Postprocessing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Postprocessing" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Postprocessing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../postprocessing/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/fibonacci/" class="md-nav__link">
        Fibonacci
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/wikipedia-ios/" class="md-nav__link">
        Wikipedia iOS
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Contributing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Contributing" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Contributing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/development-setup/" class="md-nav__link">
        Development Setup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/style-guide/" class="md-nav__link">
        Style Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/code-of-conduct/" class="md-nav__link">
        Code of Conduct
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/security/" class="md-nav__link">
        Security
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/license/" class="md-nav__link">
        License
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    API
  </a>
  
    <nav class="md-nav" aria-label="API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supported-languages" class="md-nav__link">
    Supported languages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#packaging" class="md-nav__link">
    Packaging
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#runtime-modes" class="md-nav__link">
    Runtime modes
  </a>
  
    <nav class="md-nav" aria-label="Runtime modes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#log-everything" class="md-nav__link">
    Log everything
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#circular-buffer" class="md-nav__link">
    Circular buffer
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trace" class="md-nav__link">
    Trace
  </a>
  
    <nav class="md-nav" aria-label="Trace">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#source-code" class="md-nav__link">
    Source code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#header" class="md-nav__link">
    Header
  </a>
  
    <nav class="md-nav" aria-label="Header">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#magic-number" class="md-nav__link">
    Magic number
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#endianness" class="md-nav__link">
    Endianness
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compression-strategy" class="md-nav__link">
    Compression strategy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#version" class="md-nav__link">
    Version
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session-id" class="md-nav__link">
    Session ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-id" class="md-nav__link">
    Process ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thread-id" class="md-nav__link">
    Thread ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-clock-timestamp" class="md-nav__link">
    System clock timestamp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#steady-clock-timestamp" class="md-nav__link">
    Steady clock timestamp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-count" class="md-nav__link">
    Event count
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#padding" class="md-nav__link">
    Padding
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event" class="md-nav__link">
    Event
  </a>
  
    <nav class="md-nav" aria-label="Event">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#event-id" class="md-nav__link">
    Event ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timestamp" class="md-nav__link">
    Timestamp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#payload" class="md-nav__link">
    Payload
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    Architecture
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memory-management" class="md-nav__link">
    Memory management
  </a>
  
    <nav class="md-nav" aria-label="Memory management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#buffer-pool" class="md-nav__link">
    Buffer pool
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thread-logger" class="md-nav__link">
    Thread logger
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/microsoft/spoor/edit/master/docs/reference/runtime/index.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="runtime">Runtime</h1>
<h2 id="introduction">Introduction</h2>
<p>Spoor's runtime is responsible for efficiently buffering trace events and
flushing them to disk.</p>
<h2 id="api">API</h2>
<h3 id="supported-languages">Supported languages</h3>
<p>Spoor's runtime is written in <code>C++</code> and can be extended to work in any language.
Spoor currently offers <code>C++</code> and <code>Objective-C</code> APIs, and we welcome
<a href="/contributing">contributions</a> that expose Spoor APIs natively to other
languages.</p>
<table>
<thead>
<tr>
<th>Language</th>
<th>Header</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>C++</code></td>
<td><a href="https://github.com/microsoft/spoor/blob/master/spoor/runtime/runtime.h">spoor/runtime/runtime.h</a></td>
</tr>
<tr>
<td><code>Objective-C</code></td>
<td><a href="https://github.com/microsoft/spoor/blob/master/spoor/runtime/wrappers/apple/Runtime.h">spoor/runtime/wrappers/apple/Runtime.h</a></td>
</tr>
</tbody>
</table>
<h3 id="packaging">Packaging</h3>
<p>Spoor's runtime is offered in both static and dynamic variants.</p>
<p>Additionally, the runtime has a stub implementation with a significantly smaller
binary size. This is helpful when you only want to use Spoor in development,
testing, or dogfood environments (but not in production) -- just conditionally
link against either the full or stub implementation during your build.</p>
<p>Spoor's runtime also comes packaged as an XCFramework for use on Apple
platforms.</p>
<h2 id="runtime-modes">Runtime modes</h2>
<p>Spoor's runtime can operate in two modes: Log everything mode and circular
buffer mode.</p>
<div class="admonition info">
<p class="admonition-title">Dropped events</p>
<p>Spoor drops events (instead of blocking the thread) if there is
insufficient memory in the buffer pool to hold the event. When the buffer
pool reaches capacity, the runtime flushes each thread in an attempt to
reclaim memory.</p>
</div>
<h3 id="log-everything">Log everything</h3>
<p>As the name suggests, all events are flushed to disk. A flush event can occur
manually, when a thread is relinquished, when the buffer pool reaches capacity,
or when the runtime is deinitialized.</p>
<h3 id="circular-buffer">Circular buffer</h3>
<p>In circular buffer mode, new events on a thread override old events when the
thread's circular buffer reaches capacity. When a thread is relinquished, the
flush queue retains the thread's events for a
<a href="configuration/#event-buffer-retention-duration">configurable</a> duration in anticipation of a manual
flush event. Buffered events are flushed to disk when you issue a manual flush
event.</p>
<h2 id="trace">Trace</h2>
<p>Trace files are composed of a header followed by <code>n</code> events.</p>
<h3 id="source-code">Source code</h3>
<p><a href="https://github.com/microsoft/spoor/blob/master/spoor/runtime/trace/trace.h">spoor/runtime/trace/trace.h</a></p>
<h3 id="header">Header</h3>
<h4 id="magic-number">Magic number</h4>
<p><code>0xc853706f6f720d0a1a0a</code>, Spoor's 80-bit trace file magic number.</p>
<h4 id="endianness">Endianness</h4>
<p>Value representing the endianness of the system that generated the trace file.</p>
<h4 id="compression-strategy">Compression strategy</h4>
<p>Value representing the compression strategy used to compress the trace events in
the file.</p>
<h4 id="version">Version</h4>
<p>Value representing the trace file's version.</p>
<h4 id="session-id">Session ID</h4>
<p>Identifies the session that captured the trace events. The session ID is a
random number by default to uniquely identify each run but is
<a href="configuration/#session-id">configurable</a> to easily aggregate traces across multiple
runs or processes.</p>
<h4 id="process-id">Process ID</h4>
<p>Identifies the process that captured the trace events.</p>
<h4 id="thread-id">Thread ID</h4>
<p>Identifies the thread that captured the trace events within the process.</p>
<h4 id="system-clock-timestamp">System clock timestamp</h4>
<p>Number of nanoseconds since the system clock's epoch used to derive the wall
clock time.</p>
<h4 id="steady-clock-timestamp">Steady clock timestamp</h4>
<p>Number of nanoseconds since the steady clock's epoch. The value is recorded
shortly after (effectively at the same time as) the system clock timestamp and
is used to convert the steady clock's time to the system clock's time.</p>
<h4 id="event-count">Event count</h4>
<p>Number of events in the trace file.</p>
<h4 id="padding">Padding</h4>
<p>Empty space to pad the header to 64 bytes.</p>
<h3 id="event">Event</h3>
<p>Trace events are designed to be very small, just 24 bytes, and are composed of
three pieces of data.</p>
<h4 id="event-id">Event ID</h4>
<p>The event ID represents the type of event and are represented by a 32-bit
integer. The two most common events are function entry and function exit events.</p>
<div class="admonition note">
<p class="admonition-title">Namespace</p>
<p>Events with a most significant bit of <code>0</code> are reserved.</p>
</div>
<h4 id="timestamp">Timestamp</h4>
<p>The timestamp is number of nanoseconds that have elapsed since the steady
clock's epoch.</p>
<h4 id="payload">Payload</h4>
<p>The payload is a fixed 96 bits (composed of a 64-bit integer and a 32-bit
integer) for an event to store auxiliary data.</p>
<p>The payload is fixed size to encourage developers to efficiently store their
event's data (instead of, for example, logging a string). Two common strategies
to fit an event into the payload include symbolizing static strings (e.g., log
messages) and hashing dynamic strings (e.g., account email addresses).</p>
<h2 id="architecture">Architecture</h2>
<figure>
<p><img alt="Runtime architecture" src="runtime-architecture.png" />
  </p>
<figcaption>Spoor's runtime architecture.</figcaption>
</figure>
<p><br />
<center>
  <a class="md-button" href="runtime-architecture.pdf"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"/></svg></span> runtime-architecture.pdf</a>
</center>
<br /></p>
<div class="admonition note">
<p class="admonition-title">Event buffer path</p>
<p>Notice the beautiful circular path that the event buffer follows.</p>
</div>
<h2 id="memory-management">Memory management</h2>
<p>Spoor events are buffered on each thread before being flushed to disk.</p>
<h3 id="buffer-pool">Buffer pool</h3>
<p>Event buffers are acquired from a global object pool and come in two varieties:
static and dynamic. Static buffers are allocated during Spoor's initialization
and deallocated during deinitialization. Dynamic buffers are allocated adhoc and
deallocated as soon as they are returned to the pool.</p>
<p>An application can have a combination of static and dynamic buffers in the pool.
This is useful when your application has a predicable and constant event volume.
In this case, you reserve a certain amount of memory in the static pool.
However, if your app also has occasional spikes in event volume and you do not
wish to drop events or over-allocate the static pool, you can choose to
dynamically allocate buffers to hold the remaining events.</p>
<p>The buffer's behavior is highly <a href="configuration">configurable</a> so that you can
tune Spoor's runtime behavior for your use case.</p>
<h3 id="thread-logger">Thread logger</h3>
<p>Each thread has a thread-local buffer into which it logs events. A thread's
buffer has a maximum capacity, however, it does not request the full capacity
from the global buffer pool all at once. Instead, it acquires the buffer in
<em>slices</em>. This ensues that low-volume background threads do not over-reserve
capacity from the buffer pool.</p>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../instrumentation/configuration/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Configuration" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Configuration
            </div>
          </div>
        </a>
      
      
        
        <a href="configuration/" class="md-footer__link md-footer__link--next" aria-label="Next: Configuration" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Configuration
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; Microsoft Corporation
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/microsoft/spoor" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tabs", "navigation.top"], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
        <script src="../../js/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>